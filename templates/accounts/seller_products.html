{% extends 'base.html' %}
{% load static %}

{% block title %}Мои товары - Onyx{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1 class="dashboard-title">Мои товары</h1>
    <a href="{% url 'accounts:seller_product_create' %}" class="btn btn-inline">+ Добавить товар</a>
</div>

<div class="seller-nav">
    <a href="{% url 'accounts:seller_dashboard' %}">Главная</a>
    <a href="{% url 'accounts:seller_products' %}" class="active">Товары</a>
    <a href="{% url 'accounts:seller_stats' %}">Статистика</a>
    <a href="{% url 'accounts:seller_references' %}">Справочники</a>
</div>

<div class="filters">
    <a href="{% url 'accounts:seller_products' %}" style="padding: 10px 16px; border: 1px solid #e5e5e5; border-radius: 4px; text-decoration: none; color: #000; {% if not status_filter %}background: #000; color: #fff;{% endif %}">
        Все
    </a>
    <a href="?status=active" style="padding: 10px 16px; border: 1px solid #e5e5e5; border-radius: 4px; text-decoration: none; color: #000; {% if status_filter == 'active' %}background: #000; color: #fff;{% endif %}">
        Активные
    </a>
    <a href="?status=sold" style="padding: 10px 16px; border: 1px solid #e5e5e5; border-radius: 4px; text-decoration: none; color: #000; {% if status_filter == 'sold' %}background: #000; color: #fff;{% endif %}">
        Проданные
    </a>
    <a href="?status=inactive" style="padding: 10px 16px; border: 1px solid #e5e5e5; border-radius: 4px; text-decoration: none; color: #000; {% if status_filter == 'inactive' %}background: #000; color: #fff;{% endif %}">
        Неактивные
    </a>
</div>

{% if products %}
    <table class="table">
        <thead>
            <tr>
                <th>Товар</th>
                <th>Цена</th>
                <th>Статус</th>
                <th>Дата создания</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
                <tr>
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            {% if product.images.all %}
                                <img src="{{ product.images.first.image.url }}" alt="{{ product.title }}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 4px;">
                            {% endif %}
                            <div>
                                <a href="{% url 'catalog:product_detail' product.pk %}" style="text-decoration: none; color: #000; font-weight: 500;">
                                    {{ product.title }}
                                </a>
                                {% if product.brand %}
                                    <div style="font-size: 12px; color: #666;">{{ product.brand.name }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </td>
                    <td>{{ product.price|floatformat:0 }} ₽</td>
                    <td>
                        {% if product.is_sold %}
                            <span class="status-badge status-sold">Продан</span>
                        {% elif product.is_active %}
                            <span class="status-badge status-active">Активен</span>
                        {% else %}
                            <span class="status-badge status-inactive">Неактивен</span>
                        {% endif %}
                    </td>
                    <td>{{ product.created_at|date:"d.m.Y" }}</td>
                    <td>
                        <div style="display: flex; gap: 8px;">
                            <a href="{% url 'accounts:seller_product_edit' product.pk %}" style="color: #000; text-decoration: underline; font-size: 14px;">
                                Редактировать
                            </a>
                            <a href="{% url 'accounts:seller_product_delete' product.pk %}" style="color: #c62828; text-decoration: underline; font-size: 14px;">
                                Удалить
                            </a>
                        </div>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if is_paginated %}
        <div class="pagination">
            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}">←</a>
            {% endif %}
            <span class="current">Страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}</span>
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}">→</a>
            {% endif %}
        </div>
    {% endif %}
{% else %}
    <div style="text-align: center; padding: 60px 20px;">
        <p style="font-size: 18px; color: #666; margin-bottom: 20px;">Товары не найдены</p>
        <a href="{% url 'accounts:seller_product_create' %}" class="btn btn-inline">Создать первый товар</a>
    </div>
{% endif %}
{% endblock %}

